<!--pages/inviteShare/inviteShare.wxml-->
<!-- <tabBar_top navbarData="{{navbarData}}"></tabBar_top> -->
<!-- wx:if="{{shareCoupon && invitedInfo}}" -->
<wxs src="../../utils/util.wxs" module="util" />
<block wx:if="{{shareCoupon}}">
  <view wx:if="{{shareCoupon && invitedInfo}}">
    <view class="banner">
      <image src="{{shareCoupon.banner}}" class='fadeIn animated' bindtap='distinguishImg'/>
      <view class="qrcode" wx:if="{{qrcode}}">
        <image src="{{qrcode}}" class='fadeIn animated' />
        <text>点击保存并分享</text>
      </view>
    </view>

    <view class="content">

      <view class="return-course" bindtap="handleReturnCourseTap">
        <text>返回约课</text>
        <image src="{{imgUrl}}invite/icon_arrow_right.png" />
      </view>

      <view class="invite-wrapper fadeIn animated" wx:if="{{inviteMember.name && !isShare}}">
        <image class="invite-avatar" wx:if='{{inviteMember.head_img}}' src="{{inviteMember.head_img}}" />
        <image class="invite-avatar"wx:elif='{{!inviteMember.head_img}}' src="{{imgUrl}}invite/default_header.png" />
        <view class="invite-title-wrapper">
          <view class="invite-title"><text>{{inviteMember.name}}</text>{{inviteMember.config.info1}}</view>
          <view class="invite-subtitle">{{inviteMember.config.info2}}</view>
        </view>
      </view>

      <button class="invite-btn" open-type='share'>立即邀请</button>
      <view wx:if='{{isShare}}' class="face-invite-btn" bindtap="handleFaceInviteBtnTap">面对面邀请</view>

      <view class="total-wrapper">
        <view class="total-amount">
          <view class="total-number">{{invitedInfo.invited_coupon_amount || 0}}<text class='dollor'>元</text></view>
          <view class="total-tips">代金券累计金额</view>
        </view>
        <view class="totle-line"></view>
        <view class="total-count">
          <view class="total-number">{{invitedInfo.invited_member_count || 0}}<text class='dollor'>人</text></view>
          <view class="total-tips">累计邀请人</view>
        </view>
      </view>

      <view class="invite-member-wrapper" wx:if="{{invitedInfo.invited_member_List.length}}">
        <view class="invite-member-title">
          <hr/>
          <view class="invite-member-count">已邀请好友<text>({{invitedInfo.invited_member_List.length}}人)</text></view>
          <hr/>
        </view>
        <view class="invite-member-list">
          <view class="invite-member-item" wx:for="{{invitedInfo.invited_member_List}}" wx:key="index">
            <image class="invite-member-avatar" wx:if='{{item.head_img}}' src="{{item.head_img}}" />
            <image class="invite-member-avatar"wx:elif='{{!item.head_img}}' src="{{imgUrl}}invite/default_header.png" />
            <view class="invite-member-name">{{item.nick_name}}</view>
            <view class="invite-member-time">{{item.create_time}}</view>
          </view>
        </view>
      </view>

    </view>

    <view class="tips">
      <view class="tips-title">【活动细则】</view>
      <rich-text nodes="{{shareCoupon.info}}"></rich-text>
    </view>

  </view>
</block>

<block wx:else>
  <view style="position:relative;margin-top:{{marginTopBar}}px;">
    <view class="header-background">
      <image src="{{imgUrl}}invite/header_background.png" />
    </view>
    <view class="center-background"></view>
    <view class="center-content">
      <image class="center-avatar" src="{{imgUrl}}invite/avatar.png" />
      <view class="center-name">Justin&Julie</view>
      <image class="center-qrcode" src="{{inviteQrcode}}" data-src="{{inviteQrcode}}" bindtap="previewImage" />
      <view class="center-tips">点击长按保存图片并关注<text>公众号</text></view>
      <view class='newMmeber'>新会员首单39元</view>
    </view>
  </view>
</block>
<!-- <view class='officialAccount'>
  <official-account bindload = 'bindload' binderror = 'binderror'></official-account>
</view> -->

<van-popup show="{{ showShareState }}" 
           bind:click-overlay='onCloseShareImg' 
           catchtouchmove="{{true}}" 
           safe-area-inset-bottom 
           custom-style='margin-top:-120rpx'>
    <view class='PostImgBox'>
      <view class='poste_box' id='canvas-container' style='width:100%;height:100%;;overflow:hidden'>
        <canvas canvas-id="myCanvas" style="width:100%;height:100%;overflow:hidden" class='fadeIn animated'/>
      </view>
      <view class='sharePostBtn' bindtap='savePostLocation'>保存本地</view>
    </view>
</van-popup>

<van-popup show="{{ isShadeShow }}" 
           bind:click-overlay='onClose' 
           catchtouchmove="{{true}}" 
           safe-area-inset-bottom 
           custom-style='margin-top:-120rpx;background:none;border-radius:16rpx;'>
  <view class='inviteYou'>
     <view class='lineBox'>
       <view class='line1'></view>
       <view class='ball'></view>
     </view>
     <text class='inviteYouText'>邀请您</text>
     <view class='lineBox'>
       <view class='ball'></view>
       <view class='line2'></view>
     </view>
  </view>
  <view class='qrcodeBox'>
    <image src="{{qrcode}}"  class='qrcodeImg'/>
  </view>
  <view class='qrcode-tipsBox'>
    <image src='{{imgUrl}}invite/shareImgBottom.png' class='qrcode-tipsImg'></image>
    <view class='textBox'>
      <text class="text" decode="true"><text class='textNew'>新用户扫码</text>\n领取共{{shareCoupon.amount}}元代金券</text>
    </view>
  </view>
  <image src='{{imgUrl}}invite/closeBtn.png' class='closeBtn' bindtap='onClose'></image>
</van-popup>





